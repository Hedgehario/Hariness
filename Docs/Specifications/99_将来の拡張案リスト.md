# 将来の機能拡張・改善案リスト

本プロジェクト（MVP）の開発中に出たアイデアや、リリース後（V2以降）に検討すべき機能改善案を記録する文書です。

## 1. データベース・機能設計

### 1.1 リマインダーの個体紐付け (Optional)

- **現状 (MVP)**
  - リマインダーはユーザー（飼い主）に紐付くのみ。
  - 「9時にごはん」などの全頭共通タスクには便利だが、「Aちゃんの薬」などの個別タスクはタイトルで管理する必要がある。
- **改善案**
  - `CARE_REMINDERS` テーブルに `hedgehog_id` カラムを追加する（NULL許容）。
  - UIで「対象の個体」を選べるようにする（任意選択）。
  - これにより、「Aちゃん用のリマインダー」を明確に区別でき、将来的に「リマインダー完了→お世話記録への自動転記」などの連携が可能になる。

### 1.2 単発の記録アクション (API)

- **現状 (MVP)**
  - 日々の記録は `saveDailyBatch` で一括保存する仕様。
  - カレンダーからの編集も、通院記録 (`saveHospitalVisit`) 以外は現状定義していない。
- **改善案**
  - ウィジェットやショートカット機能など、アプリを開かずにサッと記録したいニーズが出た場合、`saveWeightRecord` や `addMealRecord` などの単発APIエンドポイントを復活させる。

### 1.3 カレンダーイベントの対象指定（個体紐付け・複数・全員）

- **現状 (MVP)**
  - カレンダーイベントは「日付」と「タイトル」のみを持つシンプルなメモ機能。
  - **特定の個体に紐付ける機能はない。**
- **改善案**
  - イベント作成時に「対象の個体」を選択できるようにする。
  - その際、1匹だけでなく、複数選択や「全員」という指定も可能にする（中間テーブル `CALENDAR_EVENT_TARGETS` やフラグ `is_all_hedgehogs` の導入）。
  - ユースケース：「全員の健康診断」「AちゃんとBちゃんの合同誕生日会」など。

## 2. UI/UX改善

### 2.1 カレンダーからの記録操作

- **改善案**
  - カレンダーの日付を長押しなどで、直接「体重」や「食事」を記録できるモーダルを呼び出す。
  - 現在は「今日の記録画面」へ遷移する必要があるが、過去の日付の記録修正などがより直感的に行えるようになる。

### 2.2 カレンダーの「今後30日の予定」表示

- **現状 (MVP)**
  - カレンダー画面にはカレンダー（月表示）のみを表示し、リスト形式の「今後30日の予定」は実装しない。
- **改善案**
  - カレンダーの下部や別タブに、直近の予定をリスト形式で表示する機能を追加する。
  - カレンダーを開かなくても、直近の通院日やイベントをパッと確認できるようにする。

### 2.3 スプラッシュスクリーン

- **現状 (MVP)**
  - PWAインストール時の起動画面はデフォルト表示。
- **改善案**
  - ブランドロゴ + アプリ名を表示するカスタムスプラッシュスクリーンを作成。
  - `manifest.json` の `splash_pages` 設定や、iOS向けの `apple-touch-startup-image` を追加。

### 2.4 OGP画像・ファビコン整備

- **現状 (MVP)**
  - 基本的なファビコン（icon.png）のみ。OGP画像は未設定。
- **改善案**
  - SNSシェア用のOGP画像（og:image）を設定。
  - 各サイズのファビコン（favicon.ico、16x16、32x32）を追加。
  - Twitter Card対応。

### 2.5 ローディングスケルトンの改善

- **現状 (MVP)**
  - 基本的なローディング表示（loading.tsx）は実装済み。
- **改善案**
  - コンテンツ形状に合わせたスケルトンUI（カード型、リスト型など）を作成。
  - 汎用的な「読み込み中」ではなく、実際のコンテンツに近い形状を表示。

### 2.6 オフライン対応（PWA強化）

- **現状 (MVP)**
  - オンライン前提での動作。ネットワーク切断時はエラー表示のみ。
- **改善案**
  - **Service Worker**: オフライン時でも閲覧可能なキャッシュ戦略を導入。
  - **オフラインバナー**: ネットワーク切断時に「オフラインです」のUI表示。
  - **同期キュー**: オフライン時の入力データをローカルに保持し、オンライン復帰時に自動同期。
  - これにより、電波の悪い場所（動物病院の待合室など）でも記録が可能になる。

## 3. 分析・インサイト機能

### 3.1 グラフ機能の強化

- **現状 (MVP)**
  - 体重・温湿度の折れ線グラフ（30/90/180日）。
- **改善案**
  - 「食事量と体重の相関」など、複合的なグラフ表示。
  - 同年代の平均体重との比較（全ユーザーデータの匿名統計活用）。

### 3.2 アラート機能の具体化（UX向上）

「飼い主が気づきにくい変化」を検知し、適切なタイミングで知らせるための仕様案。

#### 1. 🚨 緊急アラート（即時通知）

- **温度・湿度異常**: 設定範囲外（例: 20℃以下/30℃以上）になった瞬間にプッシュ通知。「室温低下！ヒーター確認」など具体的アクションを促す。

#### 2. 📉 変化・予兆アラート（アプリ内バッジ/控えめな通知）

- **体重減少トレンド**: 「直近1週間で5%以上減少」などを検知し、ホーム画面で通知。「体重が減り気味です。グラフを確認しますか？」
- **食欲不振**: 「3日連続で完食なし」を検知。「最近食欲が落ちているかも？便の状態も確認してみましょう。」

#### 3. 💩 健康状態アラート

- **異常記録の連続**: 緑便・血便などが連続して記録された際、「続くようなら病院へ」とマップ導線を提示。

#### 4. 🗓️ リテンション（安否確認）

- **未記録アラート**: 丸2日記録がない場合に「お元気ですか？体重だけでも測りませんか？」と優しく通知。
